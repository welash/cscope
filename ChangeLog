2004-12-08  Neil Horman		   <nhorman@gmail.com>
	* src/dir.c: Fix to dissallow unreadable files from 
	srcfiles list (sourceforge bug number 1040690)

2004-12-06  Neil Horman		   <nhorman@gmail.com>
	* src/main.c: Fix for temp file security bug (sourceforge 
	bug number 1062807 / CAN-2004-0970)

2004-11-22  Hans-Bernhard Broeker  <broeker@physik.rwth-aachen.de>

	* doc/cscope.1: Make ESR happy: change man page summary section to
	avoid [0-9] syntax.

2004-10-27  Hans-Bernhard Broeker  <broeker@accip02.physik.rwth-aachen.de>

	* src/display.c (search): Replace duplicated code by a call to
	countrefs().  Duplicate lacked adjustment of column widths in case
	of very long function/file names.  Thanks to Darlene Wong for
	spotting this.

	* src/global.h (countrefs): Prototype added.

	* src/command.c (countrefs): Made globally available.

2004-06-23  Hans-Bernhard Broeker  <broeker@physik.rwth-aachen.de>

	* src/dir.c (makefilelist): Fix broken movement of point_in_line
	when parsing quoted names.  Simplify structure by moving default
	handling upward.

2004-06-21  Hans-Bernhard Broeker  <broeker@physik.rwth-aachen.de>

	* contrib/ocs (SYSDIR): Only set to /usr/local/lib/cs if not
	already set in outside environment.  Check that $(SYSDIR) exists
	before proceeding.  From SF patch #976788 by Neil Horman.

2004-04-30  Hans-Bernhard Broeker  <broeker@physik.rwth-aachen.de>

	* src/vpinit.c (vpinit): Renamed argument currentdir to
	current_dir to avoid name clash with same-named global.

	* src/command.c (Pattern): Renamed from "pattern", to avoid
	multitute of compiler warnings about shadowing by locally defined
	variables of the same name.  Changed all usages of this variable,
	too.
	(command): Test for individual KEY_* macros instead of TERMINFO
	whenever one of the KEY_* macros is referenced.  This should
	reduce the TERMINFO mess a little.

	* src/find.c (read_block): Renamed from "readblock", to avoid name
	clash with QNX system function of that name.  Calls changed
	accordingly, all over the place.

	* src/display.c: Fix fall-back definition of sigjmp_buf.

	* src/constants.h: Activate TERMINFO for FreeBSD.

	* src/input.c (mygetline): New function.  Poor-man's readline
	imitation.  From SF Patch #937310.

	* src/global.h (mygetline): Prototype added.

	* src/command.c (command): Use mygetline() instead of letting
	ncsurses doing it all.  Make Ctrl-B/F special hotkeys that are
	handled here instead of in mygetline(), to preserve their meaning.

	* packages/cscope.spec: Updated by SF patch #920586 to be more
	compatible with current expectations.

2004-02-24  Hans-Bernhard Broeker  <broeker@physik.rwth-aachen.de>

	* configure.in (AC_CHECK_HEADERS): Added check for NSK-Tandem
	special magic header file <floss.h>.

	* src/global.h [HAVE_FLOSS_H]: Added #include <floss.h> if it
	exists.

2004-02-14  Hans-Bernhard Broeker  <broeker@physik.rwth-aachen.de>

	* src/command.c (countrefs): Fix off-by-one length specification
	of %s format.  Thanks to <anil@recoil.org> for spotting it.

2004-02-12  Hans-Bernhard Broeker  <broeker@physik.rwth-aachen.de>

	Fix SF bug #892731: Ctrl-C interruption of search works only once
	per session.
	
	* configure.in (sigsetjmp): Added test for presence of this
	function.

	* src/display.c (sigsetjmp) [!HAVE_SIGSETJMP]: Provide fallback
	definitions for functions sigsetjmp, siglongjmp and type
	sigjmp_buf.
	(search): Move call to signal() above that to setjmp().  Call
	sigsetjmp() instead of setjmp().

	* configure, config.h.in: Regenerated.

	* Makefile.in, src/Makefile.in, contrib/Makefile.in,
	doc/Makefile.in, aclocal.m4: Rebuilt by automake-1.7.9.
	
	
2004-02-11  Hans-Bernhard Broeker  <broeker@physik.rwth-aachen.de>

	* configure.in (signal.h) Check added.
	(sighandler_t): Check for this type.  Should be defined on POSIX
	platforms, but is treated as a GNU extension sometimes.

	* src/global.h (sighandler_t) [!HAVE_SIGHANDLER_T]: Provide
	fallback definition of function pointer typedef for signal
	handlers if <signal.h> doesn't provide it. Simplifies cscope's
	work when working on its own source code --- function pointers
	confuse it quite badly, so it's best to minimize their visibility.

	* src/input.c (mygetch): Type of local variable savesig written
	using sighandler_t.

	* src/display.c (search): Type of local variable savesig written
	using sighandler_t.

	* src/exec.c (oldsigtstp): Renamed, from oldsigstp.
	(oldsigtstp,oldsighup,oldsigquit): Changed from function pointer
	type to new typedef name sighandler_t.

2004-02-05  Hans-Bernhard Broeker  <broeker@physik.rwth-aachen.de>

	* src/global.h (tolower) [BSD]: Fix stupid typo in overrides for
	toupper and tolower.

2004-01-08  Hans-Bernhard Broeker  <broeker@physik.rwth-aachen.de>

	* src/display.c (clearmsg): New function.  Does essentially the
	same thing previously achieved by a rather more cryptic
	postmsg("").
	(postfatal): New function to printout a fatal error message and
	terminate the program. Works like posterr(), but exits curses
	first, so the message should end up visible after the program
	exits.  Using this instead of posterr()+myexit() fixes SF bug
	#419510.
	(dispinit): Use postfatal:().
	(postmsg): Use clearmsg().
	(postmsg2): Call curses refresh() after change.

	* src/global.h: Add prototypes for new functions clearmsg() and
	postfatal().

	* src/find.c (putsource): Use postfatal().

	* src/main.c (main, skiplist): Use postfatal() and clearmsg().

	* src/command.c (command): Use clearmsg().

	* src/build.c (build, seek_to_trailer, movefile): Use postfatal().

	* src/alloc.c (alloctest): Use postfatal().

	* src/display.c (jumpback): Re-instate signal handler, in an
	attempt to fix problems reported with the general behaviour of
	signal handlers in cscope.

	* src/scanner.l (ws, wsnl): Two new predefined patterns to catch
	not only blanks and tabs, but all generally allowed white-space
	characters in source files: form feeds, vertical tabs, carriage
	returns.  Replaced most occurence of [ \t] and [ \t\n] by these.
	This is a back-port from fscanner.l.  Should fix SF bug #508060.

Wed Oct 15 16:05:46 2003  Hans-Bernhard Broeker  <broeker@physik.rwth-aachen.de>

	* src/dir.c (scan_dir): Don't reduce path to basename before
 	calling issrcfile.
	(issrcfile): Use either basename or full path, as necessary for
 	the individual tests.  Reorganized to reduce nesting.

Mon Sep 15 12:34:46 2003  Hans-Bernhard Broeker  <broeker@physik.rwth-aachen.de>

	* src/egrep.y (yylex, member, egrep, cgotofn): Reindented.  Fixed
 	implicit int declarations and casts.

	* src/global.h (tolower, tolower) [BSD]: Fix override definitions
 	for these so they don't mung non-alphabetic input.

Fri Sep 12 09:33:19 2003  Hans-Bernhard Broeker  <broeker@physik.rwth-aachen.de>

	* src/vp.h: Add #include of <sys/types.h> to fix problem on
 	Solaris.

Fri Sep 12 09:33:19 2003  Hans-Bernhard Broeker  <broeker@physik.rwth-aachen.de>

	I'm finally starting a new, GNU-format ChangeLog file.  The format
 	of the previous was too terse to be really useful.  This begins
 	with the first changes after release 15.5.
	
	* ChangeLog.old: New file.  Renamed copy of old-format ChangeLog
 	file.

	* ChangeLog: Started from scratch.

	
